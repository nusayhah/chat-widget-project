â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Website                                                        â”‚
â”‚ (Embeds Chat Widget via: <script data-site-key="..."></script>)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚ HTTPS/WSS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Nginx Reverse Proxy                         â”‚
â”‚ â€¢ HTTPS termination (443)                                      â”‚
â”‚ â€¢ WebSocket proxying (WSS)                                     â”‚
â”‚ â€¢ Static file serving                                          â”‚
â”‚ â€¢ Load balancing (future)                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ HTTPS (443)         â”‚ WebSocket (WSS)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Admin UI          â”‚ â”‚         Agent UI              â”‚
â”‚ â€¢ React + TailwindCSS     â”‚ â”‚ â€¢ React + TailwindCSS         â”‚
â”‚ â€¢ Port: 3000              â”‚ â”‚ â€¢ Port: 3002                  â”‚
â”‚ â€¢ Widget configuration    â”‚ â”‚ â€¢ Real-time chat interface    â”‚
â”‚ â€¢ User management         â”‚ â”‚ â€¢ Agent authentication        â”‚
â”‚ â€¢ Analytics dashboard     â”‚ â”‚ â€¢ Queue management            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚        Chat Server        â”‚ â”‚
â”‚ â€¢ Node.js + Express       â”‚â—„â”€â”€â”˜
â”‚ â€¢ WebSocket (ws)          â”‚
â”‚ â€¢ Port: 5000              â”‚
â”‚ â€¢ AI integration          â”‚
â”‚ â€¢ Session management      â”‚
â”‚ â€¢ Message routing         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     MariaDB Database      â”‚
â”‚ â€¢ Port: 3306 (internal)   â”‚
â”‚ â€¢ Port: 3307 (external)   â”‚
â”‚ â€¢ Persistent storage      â”‚
â”‚ â€¢ Session data            â”‚
â”‚ â€¢ Widget configurations   â”‚
â”‚ â€¢ Message history         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Chat Widget         â”‚
â”‚  â€¢ Embedded JavaScript    â”‚
â”‚  â€¢ TypeScript + Rollup    â”‚
â”‚  â€¢ Real-time WebSocket    â”‚
â”‚  â€¢ Responsive UI          â”‚
â”‚  â€¢ Mobile/desktop support â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š Data Flow Architecture
1. Widget Initialization Flow
text

Website Visitor â†’ Loads Widget Script â†’ Fetches Config â†’ Creates Session â†’ Connects WebSocket â†’ Starts Chat
                  â”‚                    â”‚              â”‚                 â”‚                 â”‚
                  â”‚                    â”‚              â”‚                 â”‚                 â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚              â”‚                 â”‚
                                  [JavaScript]    [REST API]       [Database]        [WebSocket]

2. Real-time Chat Flow
text

Visitor Message â†’ WebSocket â†’ Chat Server â†’ AI Processing â†’ Response
                  â”‚            â”‚             â”‚              â”‚
                  â”‚            â”‚             â”‚              â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚             â”‚
                          [WebSocket]   [Node.js]      [OpenRouter API]

3. Escalation Flow
text

Visitor Requests Human â†’ Escalation API â†’ Add to Queue â†’ Agent Accepts â†’ Agent Takes Over
                          â”‚               â”‚              â”‚               â”‚
                          â”‚               â”‚              â”‚               â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚              â”‚
                                     [REST API]     [Database]       [WebSocket]      [Agent UI]

ğŸ—„ï¸ Database Architecture
Core Tables Structure
text

widget_configs           sessions               messages              users
â”œâ”€â”€ id (PK)              â”œâ”€â”€ id (PK)            â”œâ”€â”€ id (PK)           â”œâ”€â”€ id (PK)
â”œâ”€â”€ site_key (UNIQUE)    â”œâ”€â”€ session_id (UNIQUE)â”œâ”€â”€ session_id (FK)   â”œâ”€â”€ username
â”œâ”€â”€ business_name        â”œâ”€â”€ site_key (FK)      â”œâ”€â”€ sender_type       â”œâ”€â”€ email
â”œâ”€â”€ widget_title         â”œâ”€â”€ visitor_name       â”œâ”€â”€ message           â”œâ”€â”€ password
â”œâ”€â”€ welcome_message      â”œâ”€â”€ visitor_email      â”œâ”€â”€ message_type      â””â”€â”€ timestamps
â”œâ”€â”€ primary_color        â”œâ”€â”€ visitor_info       â”œâ”€â”€ metadata
â”œâ”€â”€ secondary_color      â”œâ”€â”€ status             â””â”€â”€ timestamps
â”œâ”€â”€ position             â”œâ”€â”€ assigned_agent_id
â”œâ”€â”€ enable_prechat_form  â”œâ”€â”€ ai_mode
â”œâ”€â”€ prechat_fields       â”œâ”€â”€ escalated_at
â””â”€â”€ timestamps           â””â”€â”€ timestamps

agents (For backward compatibility)
â”œâ”€â”€ id (PK)
â”œâ”€â”€ username
â”œâ”€â”€ email
â”œâ”€â”€ password_hash
â”œâ”€â”€ full_name
â”œâ”€â”€ is_online
â””â”€â”€ timestamps

Database Relationships
text

widget_configs (1) â”€â”€â”€â”€â”€â”€â”€â”€ (âˆ) sessions
     â”‚                           â”‚
     â”‚                           â”‚
     â”‚                           â–¼
     â”‚                    messages (âˆ) â”€â”€â”€ (1) sessions
     â”‚                           â”‚
     â”‚                           â”‚
     â–¼                           â–¼
 users (1) â”€â”€â”€â”€â”€â”€â”€â”€ (âˆ) widget_configs     agents (1) â”€â”€â”€â”€ (âˆ) sessions

ğŸ”Œ API Architecture
REST API Layer (Express.js)
text

/api
â”œâ”€â”€ /auth
â”‚   â”œâ”€â”€ POST /register          # User registration
â”‚   â”œâ”€â”€ POST /login             # User login
â”‚   â”œâ”€â”€ POST /agent-login       # Agent login
â”‚   â”œâ”€â”€ GET /me                 # Current user
â”‚   â”œâ”€â”€ GET /users              # List users (admin)
â”‚   â””â”€â”€ DELETE /users/:id       # Delete user (admin)
â”‚
â”œâ”€â”€ /widgets
â”‚   â”œâ”€â”€ GET /                   # List widgets
â”‚   â”œâ”€â”€ POST /                  # Create widget
â”‚   â”œâ”€â”€ GET /:siteKey           # Get widget
â”‚   â”œâ”€â”€ PUT /:siteKey           # Update widget
â”‚   â”œâ”€â”€ DELETE /:siteKey        # Delete widget
â”‚   â”œâ”€â”€ GET /stats/overview     # Widget statistics
â”‚   â”œâ”€â”€ POST /escalate/:siteKey/:sessionId  # Escalate chat
â”‚   â”œâ”€â”€ GET /queue-position/:siteKey/:sessionId  # Queue position
â”‚   â””â”€â”€ GET /:siteKey/config    # Public widget config
â”‚
â”œâ”€â”€ /agents
â”‚   â”œâ”€â”€ GET /stats              # Agent statistics
â”‚   â”œâ”€â”€ GET /active-chats       # Active agent chats
â”‚   â””â”€â”€ GET /waiting-sessions   # Waiting sessions for queue
â”‚
â””â”€â”€ /health                     # Health check

WebSocket Architecture
text

WebSocket Server (Node.js + ws)
â”œâ”€â”€ Customer Connections
â”‚   â””â”€â”€ /ws/:sessionId
â”‚       â”œâ”€â”€ Handles visitor messages
â”‚       â”œâ”€â”€ AI response generation
â”‚       â”œâ”€â”€ Escalation triggering
â”‚       â””â”€â”€ Real-time chat updates
â”‚
â””â”€â”€ Agent Connections
    â””â”€â”€ /ws/agent/:agentId
        â”œâ”€â”€ Agent authentication (JWT)
        â”œâ”€â”€ Queue updates
        â”œâ”€â”€ Chat assignments
        â”œâ”€â”€ Real-time messaging
        â””â”€â”€ Agent status updates

ğŸ¯ Component Architecture
1. Frontend Components
text

Admin UI (React)          Agent UI (React)          Chat Widget (Vanilla JS)
â”œâ”€â”€ Auth Context          â”œâ”€â”€ Auth Context          â”œâ”€â”€ Widget Loader
â”œâ”€â”€ Dashboard             â”œâ”€â”€ Dashboard             â”œâ”€â”€ Chat Interface
â”œâ”€â”€ Widget Builder        â”œâ”€â”€ Queue Management      â”œâ”€â”€ WebSocket Client
â”œâ”€â”€ Widget List          â”œâ”€â”€ Active Chats          â”œâ”€â”€ Message Handler
â”œâ”€â”€ Analytics            â”œâ”€â”€ Chat Session          â””â”€â”€ UI Renderer
â”œâ”€â”€ User Management      â””â”€â”€ WebSocket Service
â””â”€â”€ API Services

2. Backend Components
text

Backend Server (Node.js)
â”œâ”€â”€ HTTP Server (Express)
â”‚   â”œâ”€â”€ REST API routes
â”‚   â”œâ”€â”€ Middleware (auth, validation, CORS)
â”‚   â””â”€â”€ Error handling
â”‚
â”œâ”€â”€ WebSocket Server
â”‚   â”œâ”€â”€ Connection management
â”‚   â”œâ”€â”€ Message routing
â”‚   â”œâ”€â”€ Session handling
â”‚   â””â”€â”€ Agent coordination
â”‚
â”œâ”€â”€ AI Integration
â”‚   â”œâ”€â”€ OpenRouter client
â”‚   â”œâ”€â”€ Escalation detection
â”‚   â””â”€â”€ Response generation
â”‚
â”œâ”€â”€ Database Layer
â”‚   â”œâ”€â”€ Models (User, Widget, Session, Message, Agent)
â”‚   â”œâ”€â”€ Connection pooling
â”‚   â””â”€â”€ Query handling
â”‚
â””â”€â”€ Utilities
    â”œâ”€â”€ Agent queue management
    â”œâ”€â”€ Session utilities
    â””â”€â”€ Configuration helpers

ğŸ›¡ï¸ Security Architecture
Authentication & Authorization
text

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚      â”‚   Backend API   â”‚      â”‚   Database      â”‚
â”‚                 â”‚      â”‚                 â”‚      â”‚                 â”‚
â”‚ 1. Login Form   â”‚â”€â”€â”€â–ºâ”‚ 2. Verify        â”‚â”€â”€â”€â–ºâ”‚ 3. Check         â”‚
â”‚   (email/pwd)   â”‚      â”‚   Credentials    â”‚      â”‚   User/Agent     â”‚
â”‚                 â”‚      â”‚                 â”‚      â”‚                 â”‚
â”‚ 7. Store Token  â”‚â—„â”€â”€â”€â”‚ 6. Return JWT    â”‚â—„â”€â”€â”€â”‚ 5. Generate      â”‚
â”‚ (localStorage)  â”‚      â”‚   Token          â”‚      â”‚   Token          â”‚
â”‚                 â”‚      â”‚                 â”‚      â”‚                 â”‚
â”‚ 8. API Requests â”‚â”€â”€â”€â–ºâ”‚ 9. Verify JWT    â”‚â”€â”€â”€â–ºâ”‚ 10. Check        â”‚
â”‚   (with token)  â”‚      â”‚   Middleware      â”‚      â”‚   Permissions    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

WebSocket Security

    Token Authentication: JWT verification for agent connections

    Session Validation: Unique session IDs for customer connections

    Input Sanitization: All messages are sanitized

    Rate Limiting: Connection and message rate limits

    SSL/TLS: All WebSocket connections use WSS

ğŸš€ Scalability Architecture
Current Monolithic Architecture
text

   Single Server â†’ Multiple Services â†’ Shared Database
         â”‚                â”‚                â”‚
         â”‚                â”‚                â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                 [Docker Compose]

Future Microservices Architecture (Potential)
text

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ API Gateway â”‚ â”‚ Chat Serviceâ”‚ â”‚ Agent Serviceâ”‚ â”‚  AI Service â”‚
â”‚  (Nginx)    â”‚ â”‚ (Node.js)   â”‚ â”‚ (Node.js)    â”‚ â”‚ (Node.js)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚               â”‚                â”‚               â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚                â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚           Message Bus                â”‚
            â”‚        (Redis/RabbitMQ)              â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Shared Database  â”‚
                    â”‚     (MariaDB)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”„ Communication Protocols
1. HTTP/REST

    Port: 80 (via Nginx), 3000 (Admin UI direct), 3002 (Agent UI direct), 5000 (API direct)

    Protocol: HTTP/1.1

    Content Type: JSON

    Authentication: Bearer Token (JWT)

    Local URLs:

        Admin UI: http://localhost:3000 or http://localhost

        Agent UI: http://localhost/agent or http://localhost:3002

        API: http://localhost:5000/api

        Health Check: http://localhost:5000/api/health

2. WebSocket

    Port: 5000 (direct), 80 (via Nginx proxy)

    Protocol: WebSocket over HTTP

    Message Format: JSON

    Keep-alive: Ping/pong every 25 seconds

    Local URLs:

        Customer: ws://localhost:5000/ws/:sessionId

        Agent: ws://localhost:5000/ws/agent/:agentId

3. Database

    Port: 3306 (internal Docker), 3307 (external access)

    Protocol: MySQL/MariaDB

    Connection Pool: 10 connections

    Timeout: 60 seconds

    Local Connection: mysql -h localhost -P 3307 -u chatuser -pchat123 chatdb

ğŸ“¦ Deployment Architecture
Container Architecture
text

Docker Compose Stack
â”œâ”€â”€ mariadb:10.11          # Database container
â”‚   â””â”€â”€ Volume: mariadb_data
â”‚
â”œâ”€â”€ server                 # Backend API container
â”‚   â””â”€â”€ Build: ./backend
â”‚
â”œâ”€â”€ admin-ui               # Admin interface container
â”‚   â””â”€â”€ Build: ./admin-ui
â”‚
â”œâ”€â”€ agent-ui               # Agent interface container
â”‚   â””â”€â”€ Build: ./agent-ui
â”‚
â””â”€â”€ nginx                  # Reverse proxy container
    â””â”€â”€ Build: ./nginx
    â””â”€â”€ Volumes:
        - ./static:/var/www/static

Network Architecture
text

chat-network (bridge)
â”œâ”€â”€ mariadb:3306      # Internal DB access (container-to-container)
â”œâ”€â”€ server:5000       # Internal API access
â”œâ”€â”€ admin-ui:3000     # Internal admin UI
â”œâ”€â”€ agent-ui:3002     # Internal agent UI
â””â”€â”€ nginx:80          # External access point

External Port Mapping:
â”œâ”€â”€ localhost:80      â†’ nginx:80          (Main access)
â”œâ”€â”€ localhost:3000    â†’ admin-ui:3000     (Direct Admin UI)
â”œâ”€â”€ localhost:3002    â†’ agent-ui:3002     (Direct Agent UI)
â”œâ”€â”€ localhost:5000    â†’ server:5000       (Direct API)
â””â”€â”€ localhost:3307    â†’ mariadb:3306      (Direct DB access)

ğŸ¨ UI/UX Architecture
Responsive Design Strategy
text

Breakpoints:
â”œâ”€â”€ Mobile: < 768px
â”‚   â””â”€â”€ Full-screen sidebar chat
â”‚   â””â”€â”€ Larger touch targets
â”‚   â””â”€â”€ Simplified navigation
â”‚
â”œâ”€â”€ Tablet: 768px - 1024px
â”‚   â””â”€â”€ Adaptive layouts
â”‚   â””â”€â”€ Responsive grids
â”‚   â””â”€â”€ Touch-friendly interfaces
â”‚
â””â”€â”€ Desktop: > 1024px
    â””â”€â”€ Compact chat windows
    â””â”€â”€ Sidebar navigation
    â””â”€â”€ Multi-column layouts

Component Design System
text

Design Tokens:
â”œâ”€â”€ Colors
â”‚   â”œâ”€â”€ Primary: #007bff (configurable per widget)
â”‚   â”œâ”€â”€ Secondary: #6c757d (configurable per widget)
â”‚   â””â”€â”€ Semantic colors (success, warning, error)
â”‚
â”œâ”€â”€ Typography
â”‚   â”œâ”€â”€ Font family: Inter, system-ui, sans-serif
â”‚   â”œâ”€â”€ Font sizes: 12px - 32px scale
â”‚   â””â”€â”€ Line heights: 1.4 - 1.8
â”‚
â”œâ”€â”€ Spacing
â”‚   â”œâ”€â”€ Base unit: 4px
â”‚   â”œâ”€â”€ Scale: 4, 8, 12, 16, 20, 24, 32, 40, 48, 64
â”‚   â””â”€â”€ Container widths: 350px (chat), 800px (content)
â”‚
â””â”€â”€ Shadows & Effects
    â”œâ”€â”€ Elevation levels: 0-3
    â”œâ”€â”€ Transitions: 0.3s cubic-bezier(0.4, 0, 0.2, 1)
    â””â”€â”€ Border radius: 4px, 8px, 12px, 20px, 50%

ğŸ” Monitoring & Logging Architecture
Current Implementation
text

Application Logging:
â”œâ”€â”€ Console logging (development)
â”œâ”€â”€ Structured JSON logging (production)
â”œâ”€â”€ Error tracking
â””â”€â”€ Performance metrics

Database Monitoring:
â”œâ”€â”€ Connection health checks
â”œâ”€â”€ Query performance
â””â”€â”€ Table statistics

WebSocket Monitoring:
â”œâ”€â”€ Connection counts
â”œâ”€â”€ Message rates
â””â”€â”€ Session tracking

Future Enhancement Points
text

Observability Stack:
â”œâ”€â”€ Metrics (Prometheus)
â”œâ”€â”€ Logging (ELK Stack)
â”œâ”€â”€ Tracing (Jaeger)
â””â”€â”€ Alerting (Alertmanager)

Health Checks:
â”œâ”€â”€ API endpoints (/api/health)
â”œâ”€â”€ Database connectivity
â”œâ”€â”€ External service status
â””â”€â”€ Resource utilization

ğŸ¯ Key Architectural Decisions
1. Technology Stack Choices

    Frontend: React for complex UIs, Vanilla JS for lightweight widget

    Backend: Node.js for real-time capabilities

    Database: MariaDB for relational data structure

    WebSocket: Native ws library for performance

    Containerization: Docker for consistency

    Local Development: All services run on localhost with specific ports

2. Real-time Architecture

    Bidirectional Communication: WebSocket for real-time chat

    Session Management: In-memory with database persistence

    Message Queue: In-memory agent queue (scalable to Redis)

    Local Testing: WebSocket connections via ws://localhost:5000

3. Security Architecture

    JWT Tokens: Stateless authentication with 7-day expiration

    CORS Configuration: Strict localhost origin validation

    Input Validation: Both client and server-side validation

    SQL Injection Prevention: Parameterized queries via mysql2

    Local Network Security: Firewall rules for exposed ports

4. Deployment Architecture

    Local Development: All services accessible via localhost

    Reverse Proxy: Nginx for routing and static file serving

    Containerization: Docker Compose for easy setup

    Environment Variables: Configuration via .env files

    Port Configuration:

        Admin UI: 3000

        Agent UI: 3002

        API: 5000

        Nginx: 80

        Database: 3307 (external), 3306 (internal)

ğŸ“ˆ Performance Characteristics
Local Development Capacity

    Concurrent Users: 50-100 (local testing)

    Message Throughput: ~50 messages/second

    Database Connections: 10 concurrent connections

    WebSocket Connections: ~500 concurrent connections

    Memory Usage: ~1GB total for all containers

    CPU Usage: ~10-20% on typical hardware

Local Network Access
text

Same Network Access:
â”œâ”€â”€ Admin UI:     http://<local-ip>:3000
â”œâ”€â”€ Agent UI:     http://<local-ip>/agent
â”œâ”€â”€ API:          http://<local-ip>:5000/api
â””â”€â”€ Test Widget:  http://<local-ip>/test-widget.html

Where <local-ip> = Your computer's IP on the network
Example: 192.168.1.100

Optimization for Local Development

    Database Indexing: Optimized indexes for common queries

    Connection Pooling: 10 database connections for concurrent access

    Memory Management: Automatic cleanup of inactive sessions

    File Caching: Nginx static file caching for widget assets

    Development Mode: Hot reload for frontend development

Local Testing Scenarios
text

Test Coverage:
â”œâ”€â”€ Unit Testing: API endpoints, models, utilities
â”œâ”€â”€ Integration: Database operations, WebSocket communication
â”œâ”€â”€ UI Testing: Admin/Agent interface functionality
â”œâ”€â”€ Widget Testing: Embeddable chat widget behavior
â””â”€â”€ End-to-End: Complete chat flow with AI and escalation

This architecture provides a comprehensive, production-ready foundation for the chat widget system that runs seamlessly on localhost while maintaining clear separation of concerns and supporting real-time communication requirements. The localhost configuration ensures easy development, testing, and demonstration while maintaining the structure needed for future deployment to production environments.